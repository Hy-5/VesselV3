// Copyright 2023 QMK
// SPDX-License-Identifier: GPL-2.0-or-later

#include QMK_KEYBOARD_H
#include "keymap_french.h"
#include "print.h"
#include "timer.h"


/***** rgblight_mode(mode)/rgblight_mode_noeeprom(mode) ****

SHOULD WORK with new name modes but for some reason won't compile unless I give it the number instead. Last time tested QMK 0.23.5

|-----------------|-----------------------------------|
| old mode number | new mode name                     |
|-----------------|-----------------------------------|
|        1        | RGBLIGHT_MODE_STATIC_LIGHT        |
|        2        | RGBLIGHT_MODE_BREATHING           |
|        3        | RGBLIGHT_MODE_BREATHING + 1       |
|        4        | RGBLIGHT_MODE_BREATHING + 2       |
|        5        | RGBLIGHT_MODE_BREATHING + 3       |
|        6        | RGBLIGHT_MODE_RAINBOW_MOOD        |
|        7        | RGBLIGHT_MODE_RAINBOW_MOOD + 1    |
|        8        | RGBLIGHT_MODE_RAINBOW_MOOD + 2    |
|        9        | RGBLIGHT_MODE_RAINBOW_SWIRL       |
|       10        | RGBLIGHT_MODE_RAINBOW_SWIRL + 1   |
|       11        | RGBLIGHT_MODE_RAINBOW_SWIRL + 2   |
|       12        | RGBLIGHT_MODE_RAINBOW_SWIRL + 3   |
|       13        | RGBLIGHT_MODE_RAINBOW_SWIRL + 4   |
|       14        | RGBLIGHT_MODE_RAINBOW_SWIRL + 5   |
|       15        | RGBLIGHT_MODE_SNAKE               |
|       16        | RGBLIGHT_MODE_SNAKE + 1           |
|       17        | RGBLIGHT_MODE_SNAKE + 2           |
|       18        | RGBLIGHT_MODE_SNAKE + 3           |
|       19        | RGBLIGHT_MODE_SNAKE + 4           |
|       20        | RGBLIGHT_MODE_SNAKE + 5           |
|       21        | RGBLIGHT_MODE_KNIGHT              |
|       22        | RGBLIGHT_MODE_KNIGHT + 1          |
|       23        | RGBLIGHT_MODE_KNIGHT + 2          |
|       24        | RGBLIGHT_MODE_CHRISTMAS           |
|       25        | RGBLIGHT_MODE_STATIC_GRADIENT     |
|       26        | RGBLIGHT_MODE_STATIC_GRADIENT + 1 |
|       27        | RGBLIGHT_MODE_STATIC_GRADIENT + 2 |
|       28        | RGBLIGHT_MODE_STATIC_GRADIENT + 3 |
|       29        | RGBLIGHT_MODE_STATIC_GRADIENT + 4 |
|       30        | RGBLIGHT_MODE_STATIC_GRADIENT + 5 |
|       31        | RGBLIGHT_MODE_STATIC_GRADIENT + 6 |
|       32        | RGBLIGHT_MODE_STATIC_GRADIENT + 7 |
|       33        | RGBLIGHT_MODE_STATIC_GRADIENT + 8 |
|       34        | RGBLIGHT_MODE_STATIC_GRADIENT + 9 |
|       35        | RGBLIGHT_MODE_RGB_TEST            |
|       36        | RGBLIGHT_MODE_ALTERNATING         |
|       37        | RGBLIGHT_MODE_TWINKLE             |
|       38        | RGBLIGHT_MODE_TWINKLE + 1         |
|       39        | RGBLIGHT_MODE_TWINKLE + 2         |
|       40        | RGBLIGHT_MODE_TWINKLE + 3         |
|       41        | RGBLIGHT_MODE_TWINKLE + 4         |
|       42        | RGBLIGHT_MODE_TWINKLE + 5         |
|-----------------|-----------------------------------|
 *****/
 
// custom keycode example
/*enum custom_keycodes {
    PB_1 = SAFE_RANGE, // Ensure this doesn't conflict with existing keycodes
    // Other custom keycodes can follow
};*/

 
 static uint32_t keyboard_idle_timer = 0;


const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
     
     /*
         *┌───┬───┐ ┌───┬───┐ ┌───┬───┐ ┌───┬───┐ ┌───┬───┐ ┌───┬───┐ ┌───┬───┬───┐
         *│M1 │M2 │ │M3 │M4 │ │M5 │M6 │ │M7 │M8 │ │M9 │M10│ │M11│M12│ │Pre│Pla│Nex│
         *└───┴───┘ └───┴───┘ └───┴───┘ └───┴───┘ └───┴───┘ └───┴───┘ └───┴───┴───┘
         *┌───┐ ┌───┬───┬───┬───┐ ┌───┬───┬───┬───┐ ┌───┬───┬───┬───┐ ┌───┬───┬───┐
         *│Esc│ │F1 │F2 │F3 │F4 │ │F5 │F6 │F7 │F8 │ │F9 │F10│F11│F12│ │PSc│OC │Lay│
         *└───┘ └───┴───┴───┴───┘ └───┴───┴───┴───┘ └───┴───┴───┴───┘ └───┴───┴───┘
         *┌───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───────┐   ┌───┬───┐
         *│ ² │ 1 │ 2 │ 3 │ 4 │ 5 │ 6 │ 7 │ 8 │ 9 │ 0 │ ° │ + │ Backsp│   │Hom│End│
         *├───┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─────┤   ├───┼───┤
         *│ Tab │ A │ Z │ E │ R │ T │ Y │ U │ I │ O │ P │ ¨ │ £ │     │   │Ins│PUp│
         *├─────┴┬──┴┬──┴┬──┴┬──┴┬──┴┬──┴┬──┴┬──┴┬──┴┬──┴┬──┴┬──┴┐ Ent│   ├───┼───┤
         *│ Caps │ Q │ S │ D │ F │ G │ H │ J │ K │ L │ M │ % │ µ │    │   │Del│PDn│             
         *├────┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴───┴┬───┤   └───┼───┤   
         *│Shft│ > │ W │ X │ C │ V │ B │ N │ ? │ . │ / │ § │Shift │ ↑ │       │T22│
         *├────┼───┴┬──┴─┬─┴───┴───┴───┴───┴───┴──┬┴───┼───┴┬─┬───┼───┼───┐ ┌─┴───┤
         *│Ctrl│GUI │Alt │          Space         │Alt │Menu│ │ ← │ ↓ │ → │ │(Enc)│
         *└────┴────┴────┴────────────────────────┴────┴────┘ └───┴───┴───┘ └─────┘
         *
     */
     
     
        [0] = LAYOUT_all(
        KC_F13,           KC_F14,   KC_F15,   KC_F16,   KC_F17,   KC_F18,   KC_F19,   KC_F20,   KC_F21,   KC_F22,   KC_F23,  KC_F24,     KC_MPRV, KC_MPLY, KC_MNXT,
        KC_ESC,           KC_F1,   KC_F2,   KC_F3,   KC_F4,   KC_F5,   KC_F6,   KC_F7,   KC_F8,   KC_F9,   KC_F10,  KC_F11,  KC_F12,     KC_PSCR, PB_1, PB_2,
        KC_GRV,  KC_1,    KC_2,    KC_3,    KC_4,    KC_5,    KC_6,    KC_7,    KC_8,    KC_9,    KC_0,    KC_MINS, KC_EQL,  KC_BSPC,    KC_HOME, KC_END,
        KC_TAB,  KC_Q,    KC_W,    KC_E,    KC_R,    KC_T,    KC_Y,    KC_U,    KC_I,    KC_O,    KC_P,    KC_LBRC, KC_RBRC, KC_ENT,     KC_INS,  KC_PGUP,
        KC_CAPS, KC_A,    KC_S,    KC_D,    KC_F,    KC_G,    KC_H,    KC_J,    KC_K,    KC_L,    KC_SCLN, KC_QUOT, KC_NUHS,             KC_DEL,  KC_PGDN,
        KC_LSFT, KC_NUBS, KC_Z,    KC_X,    KC_C,    KC_V,    KC_B,    KC_N,    KC_M,    KC_COMM, KC_DOT,  KC_SLSH, KC_RSFT,  KC_UP,              PB_3,
        KC_LCTL, KC_LGUI, KC_LALT,                            KC_SPC,                             KC_RALT, KC_APP,  KC_LEFT, KC_DOWN, KC_RGHT
    )
};


#if defined(ENCODER_MAP_ENABLE)
bool encoder_update_user(uint8_t index, bool clockwise) {
    if (index == 0) {
        if (clockwise) {
            uprintf("Encoder turned clockwise\n");
            tap_code(KC_VOLU); // temporary action for testing
        } else {
            uprintf("Encoder turned counter-clockwise\n");
            tap_code(KC_VOLD); // temporary action for testing
        }
    }
    return true;
}
#endif

#ifdef OLED_ENABLE
    
// Animation parameters
#define FRAME_DURATION 130 // How long each frame lasts in milliseconds

// Animation variables
uint32_t timer = 0;
uint8_t current_frame = 0;
static bool animation_enabled = true;
uint32_t anim_timer = 0;
static uint32_t anim_off_timer = 0;


// animation rendering
bool animation_on(void) {
    if (!animation_enabled) return false; // Exit if animation is disabled
        // 'frame_0_delay-0', 128x64px
        static const char epd_bitmap_frame_0_delay_0 [] PROGMEM = {
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x80, 0xE0, 0xC0, 0xA0,
            0xA0, 0x00, 0x00, 0x4C, 0x38, 0x78,
            0x7C, 0xAC, 0x30, 0xB0, 0xB0, 0x80,
            0x00, 0xE0, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x07, 0xF3, 0xC7,
            0x7F, 0xFF, 0xF7, 0x7F, 0xFE, 0xFF,
            0xDE, 0x9F, 0xBF, 0xFF, 0xC3, 0x81,
            0x81, 0x81, 0x80, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x01, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x01, 0x07,
            0x0C, 0x71, 0x27, 0x5F, 0x7F, 0x73,
            0x68, 0x02, 0x2E, 0x1C, 0x70, 0x18,
            0x04, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x40, 0x80, 0xF8, 0xF0, 0xE0,
            0xC0, 0x80, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x80, 0x80, 0x00, 0x40, 0xE0, 0x80,
            0xC0, 0xE0, 0xC0, 0xC6, 0xF0, 0xF8,
            0xBC, 0xC0, 0x00, 0x80, 0x00, 0x00,
            0x00, 0x00, 0xE0, 0xE0, 0x40, 0x00,
            0x00, 0x60, 0xB0, 0xE0, 0x86, 0x02,
            0x30, 0xF4, 0xF0, 0xF3, 0xFB, 0x7B,
            0x08, 0x08, 0x07, 0x87, 0xC3, 0xC3,
            0xEF, 0xF9, 0x79, 0x9F, 0x9F, 0xBE,
            0x9C, 0xC8, 0xE8, 0xD8, 0xD0, 0xE0,
            0x20, 0xB0, 0xC0, 0x80, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0xE0, 0xA0, 0x38, 0x3C,
            0xB8, 0x24, 0xC0, 0x02, 0x10, 0x00,
            0x18, 0x3C, 0x3C, 0x3F, 0x3F, 0x3F,
            0x35, 0x15, 0x17, 0x23, 0x21, 0x01,
            0x07, 0x05, 0x01, 0x0F, 0x0F, 0x0E,
            0x0C, 0x1C, 0x1C, 0x34, 0x36, 0x3E,
            0x6E, 0x26, 0x36, 0x24, 0x84, 0x07,
            0x07, 0x09, 0x0F, 0x0F, 0x0F, 0x0F,
            0x0E, 0x0E, 0x06, 0x0E, 0x07, 0x07,
            0x07, 0x17, 0x1D, 0x3C, 0x14, 0x1E,
            0x1F, 0xFF, 0x3C, 0x7C, 0xBF, 0xFF,
            0xBF, 0x7F, 0x7F, 0x3B, 0x6B, 0x6B,
            0x63, 0xFA, 0x33, 0x9F, 0x8E, 0xFC,
            0xE4, 0xFC, 0xE8, 0xE8, 0x30, 0xE0,
            0xC0, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x07, 0x19, 0x19, 0x0F, 0x26,
            0x40, 0x2E, 0x1D, 0x1F, 0x3F, 0x3E,
            0x3E, 0x7E, 0xFD, 0xFD, 0xCF, 0x00,
            0x18, 0x34, 0x32, 0xF0, 0x79, 0x7E,
            0xFE, 0xFE, 0xFC, 0xFC, 0xFC, 0xFC,
            0xF8, 0x3C, 0x12, 0x3E, 0xFC, 0xF8,
            0xFE, 0xC3, 0xC0, 0xFC, 0x83, 0x81,
            0x9C, 0x9E, 0xFF, 0xFE, 0xFA, 0xF4,
            0xFC, 0x8F, 0x9F, 0xFD, 0xFD, 0xFF,
            0xFE, 0xFE, 0xFE, 0xFE, 0xFF, 0xFE,
            0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFE,
            0xFE, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFF, 0x7F, 0x7F,
            0x3F, 0x07, 0x03, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x02, 0x07, 0x07, 0x0F,
            0x1C, 0x38, 0x39, 0x38, 0x3E, 0x1F,
            0x1F, 0x32, 0x3A, 0x18, 0x20, 0x62,
            0x42, 0xC0, 0x06, 0x0F, 0x3F, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFD, 0xFC, 0xC0,
            0xF8, 0xF1, 0xFD, 0xFF, 0xFF, 0xFF,
            0xFC, 0xFF, 0xFF, 0xFF, 0xFF, 0xE7,
            0xB9, 0x01, 0x01, 0x07, 0xE7, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFF, 0x73, 0x00,
            0x4F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
            0x7F, 0x3F, 0x0F, 0x1F, 0x3F, 0x1F,
            0x0F, 0x0F, 0x0F, 0x07, 0x03, 0x01,
            0x01, 0x03, 0x07, 0x07, 0x03, 0x01,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x06, 0x03, 0x01, 0x01, 0x01, 0x01,
            0x01, 0x01, 0x01, 0x01, 0x01, 0x00,
            0x00, 0x07, 0x07, 0x03, 0x03, 0x0F,
            0x0F, 0x0F, 0x07, 0x1E, 0x24, 0x1C,
            0x0F, 0x0F, 0x07, 0x01, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x01, 0x01,
            0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00,
        };
        // 'frame_1_delay-0', 128x64px
        static const char epd_bitmap_frame_1_delay_0 [] PROGMEM = {
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x80, 0x80, 0xE0, 0xC0, 0xA0,
            0xA0, 0x30, 0x00, 0x4C, 0x38, 0x78,
            0x6C, 0xA8, 0x70, 0xB0, 0xF0, 0x90,
            0x00, 0xE0, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x07, 0xF3, 0xE7,
            0xFF, 0xFF, 0xF7, 0x77, 0xFF, 0xFE,
            0xDF, 0x9F, 0xBF, 0xFF, 0xC7, 0x81,
            0x81, 0x81, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x01, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x02, 0x00, 0x01, 0x07,
            0x0C, 0x51, 0x27, 0x5F, 0x7F, 0x73,
            0x68, 0x52, 0x3F, 0x0E, 0x30, 0x14,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x40, 0x80, 0xF0, 0xF0, 0xE0,
            0xC0, 0x80, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x80, 0x00,
            0x80, 0x80, 0x00, 0x40, 0xE0, 0x80,
            0xC0, 0xE0, 0xC0, 0xC6, 0xF0, 0xF8,
            0xBC, 0xC0, 0x00, 0x80, 0x00, 0x00,
            0x00, 0x00, 0xE0, 0xE0, 0x40, 0x00,
            0x00, 0x60, 0xB0, 0xA0, 0x86, 0x02,
            0x70, 0xF4, 0xF0, 0xF3, 0xFB, 0x7B,
            0x08, 0x08, 0x07, 0x87, 0xC3, 0xC3,
            0xEF, 0xF9, 0x79, 0x9F, 0x9E, 0xBE,
            0x9C, 0xC8, 0xE8, 0xD8, 0xD0, 0xE0,
            0x20, 0xB0, 0xC0, 0x80, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0xE0, 0xA0, 0x38, 0x3C,
            0xBC, 0x24, 0xC0, 0x02, 0x10, 0x00,
            0x18, 0x3C, 0x3C, 0x3F, 0x1F, 0x3F,
            0x35, 0x15, 0x07, 0x23, 0x21, 0x01,
            0x07, 0x05, 0x01, 0x0F, 0x0F, 0x0E,
            0x0E, 0x1C, 0x1C, 0x34, 0x36, 0x3F,
            0x6E, 0x27, 0x37, 0x24, 0x84, 0x07,
            0x07, 0x09, 0x0F, 0x0F, 0x0F, 0x0F,
            0x0E, 0x0E, 0x06, 0x0E, 0x07, 0x07,
            0x07, 0x17, 0x1D, 0x3C, 0x14, 0x1E,
            0x1F, 0xFF, 0x3C, 0x7C, 0x9F, 0xFF,
            0xBF, 0x7F, 0x7F, 0x3B, 0x6B, 0x6B,
            0x63, 0xFA, 0x33, 0x9F, 0x8E, 0xFC,
            0xE4, 0xFC, 0xE8, 0xE8, 0x30, 0xE0,
            0xC0, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x07, 0x19, 0x19, 0x0F, 0x26,
            0x40, 0x2E, 0x1D, 0x1F, 0x3F, 0x3E,
            0x3E, 0x7E, 0xFF, 0xFD, 0xCF, 0x00,
            0x18, 0x34, 0x32, 0xF0, 0x79, 0x7E,
            0xFE, 0xFE, 0xFC, 0xFC, 0xFC, 0xFC,
            0xF8, 0x3C, 0x12, 0x3E, 0xFC, 0xF8,
            0xFE, 0xC3, 0xC0, 0xFC, 0x83, 0x81,
            0x9C, 0x9E, 0xFF, 0xFE, 0xFA, 0xF4,
            0xFC, 0x8F, 0x9F, 0xFD, 0xFD, 0xFF,
            0xFE, 0xFE, 0xFE, 0xFE, 0xFF, 0xFE,
            0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFE,
            0xFE, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFF, 0x7F, 0x7F,
            0x3F, 0x07, 0x03, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x02, 0x07, 0x07, 0x0F,
            0x1C, 0x38, 0x39, 0x38, 0x3E, 0x1F,
            0x1F, 0x32, 0x3A, 0x18, 0x20, 0x62,
            0x42, 0xC0, 0x06, 0x0F, 0x3F, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFD, 0xFC, 0xC0,
            0xF8, 0xF1, 0xFD, 0xFF, 0xFF, 0xFF,
            0xFC, 0xFF, 0xFF, 0xFF, 0xFF, 0xE7,
            0xB9, 0x01, 0x01, 0x07, 0xE7, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFF, 0x73, 0x00,
            0x4F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
            0x7F, 0x3F, 0x0F, 0x1F, 0x3F, 0x1F,
            0x0F, 0x0F, 0x0F, 0x07, 0x03, 0x01,
            0x01, 0x03, 0x07, 0x07, 0x03, 0x01,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x06, 0x03, 0x01, 0x01, 0x01, 0x01,
            0x01, 0x01, 0x01, 0x01, 0x01, 0x00,
            0x00, 0x07, 0x07, 0x03, 0x03, 0x0F,
            0x0F, 0x0F, 0x07, 0x1E, 0x24, 0x1C,
            0x0F, 0x0F, 0x07, 0x01, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x01, 0x01,
            0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00,
        };
        // 'frame_2_delay-0', 128x64px
        static const char epd_bitmap_frame_2_delay_0 [] PROGMEM = {
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x80, 0x80, 0xE0, 0xC0, 0xE0,
            0x20, 0x60, 0x40, 0xCC, 0x38, 0x68,
            0x6C, 0xA0, 0xA0, 0xB0, 0xF0, 0x90,
            0x80, 0x40, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x87, 0xF3, 0xE7,
            0xFF, 0xFF, 0xF7, 0xF7, 0xFF, 0xFE,
            0xDE, 0xBF, 0xBF, 0xFF, 0xC3, 0x81,
            0x81, 0x81, 0x80, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x01, 0x00, 0x00, 0x00, 0x00,
            0x01, 0x00, 0x00, 0x00, 0x01, 0x07,
            0x0C, 0x61, 0x3F, 0x4F, 0x7F, 0x73,
            0x28, 0x5A, 0x3F, 0x2F, 0x30, 0x10,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x40, 0x80, 0xF8, 0xF0, 0xE0,
            0xC0, 0x80, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x80, 0x00,
            0x80, 0x80, 0x00, 0x40, 0xE0, 0x80,
            0xC0, 0xE0, 0xC0, 0xC6, 0xF0, 0xF8,
            0xBC, 0xC0, 0x00, 0x80, 0x00, 0x00,
            0x00, 0x00, 0xE0, 0xE0, 0x40, 0x00,
            0x00, 0x60, 0x30, 0xE0, 0x86, 0x02,
            0x60, 0xF4, 0xF0, 0xF3, 0xFB, 0x3B,
            0x08, 0x08, 0x07, 0x87, 0xC3, 0xC3,
            0xEF, 0xF9, 0x79, 0x9F, 0x9F, 0xBE,
            0x9C, 0xC8, 0xE8, 0xD8, 0xD0, 0xE0,
            0x60, 0x30, 0xC0, 0x80, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0xE0, 0xA0, 0x38, 0x38,
            0xBC, 0x24, 0xC0, 0x02, 0x12, 0x00,
            0x18, 0x3C, 0x3C, 0x3F, 0x3F, 0x3F,
            0x35, 0x15, 0x17, 0x23, 0x31, 0x01,
            0x07, 0x05, 0x01, 0x0F, 0x0F, 0x0E,
            0x0C, 0x1C, 0x1C, 0x34, 0x36, 0x3F,
            0x6E, 0x27, 0x37, 0x24, 0x84, 0x07,
            0x07, 0x09, 0x0F, 0x0F, 0x0F, 0x0F,
            0x0E, 0x0E, 0x06, 0x0E, 0x0F, 0x07,
            0x07, 0x17, 0x1D, 0x3C, 0x14, 0x1E,
            0x1F, 0xFF, 0x3C, 0x7C, 0xBF, 0xFF,
            0xBF, 0x7F, 0x7F, 0x3B, 0x6B, 0x6B,
            0x63, 0xFA, 0x33, 0x9F, 0x8E, 0xFC,
            0xE4, 0xFC, 0xE8, 0xE8, 0x30, 0xE0,
            0xC0, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x07, 0x19, 0x19, 0x0F, 0x26,
            0x40, 0x2E, 0x1D, 0x1F, 0x3F, 0x3E,
            0x3E, 0x7E, 0xFD, 0xFF, 0xCF, 0x00,
            0x18, 0x34, 0x32, 0xF0, 0x79, 0x7E,
            0xFE, 0xFE, 0xFC, 0xFC, 0xFC, 0xFC,
            0xF8, 0x3C, 0x12, 0x3E, 0xFC, 0xF8,
            0xFE, 0xC3, 0xC0, 0xFC, 0x83, 0x81,
            0x9C, 0x9E, 0xFF, 0xFE, 0xFA, 0xF4,
            0xFC, 0x8F, 0x9F, 0xFD, 0xFD, 0xFF,
            0xFE, 0xFE, 0xFE, 0xFE, 0xFF, 0xFE,
            0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFE,
            0xFE, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFF, 0x7F, 0x7F,
            0x3F, 0x07, 0x03, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x02, 0x07, 0x07, 0x0F,
            0x1C, 0x38, 0x39, 0x38, 0x3E, 0x1F,
            0x1F, 0x32, 0x3A, 0x18, 0x20, 0x62,
            0x42, 0xC0, 0x06, 0x0F, 0x3F, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFD, 0xFC, 0xC0,
            0xF8, 0xF1, 0xFD, 0xFF, 0xFF, 0xFF,
            0xFC, 0xFF, 0xFF, 0xFF, 0xFF, 0xE7,
            0xB9, 0x01, 0x01, 0x07, 0xE7, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFF, 0x73, 0x00,
            0x4F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
            0x7F, 0x3F, 0x0F, 0x1F, 0x3F, 0x1F,
            0x0F, 0x0F, 0x0F, 0x07, 0x03, 0x01,
            0x01, 0x03, 0x07, 0x07, 0x03, 0x01,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x06, 0x03, 0x01, 0x01, 0x01, 0x01,
            0x01, 0x01, 0x01, 0x01, 0x01, 0x00,
            0x00, 0x07, 0x07, 0x03, 0x03, 0x0F,
            0x0F, 0x0F, 0x07, 0x1E, 0x24, 0x1C,
            0x0F, 0x0F, 0x07, 0x01, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x01, 0x01,
            0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00,
        };
        // 'frame_3_delay-0', 128x64px
        static const char epd_bitmap_frame_3_delay_0 [] PROGMEM = {
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x80, 0x80, 0xC0, 0xE0, 0xA0,
            0xA0, 0x10, 0xC0, 0x4C, 0x38, 0x68,
            0x6C, 0xA4, 0x30, 0xB0, 0xB0, 0x90,
            0x80, 0xC0, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x87, 0xF3, 0xE7,
            0x7F, 0xFF, 0xF7, 0x7F, 0xFF, 0xFF,
            0xDF, 0x9F, 0xBF, 0xFF, 0xC3, 0x81,
            0x80, 0x81, 0x80, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x01, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x01, 0x07,
            0x0C, 0x71, 0x3F, 0x2F, 0x7F, 0x73,
            0x68, 0x5A, 0x36, 0x0E, 0x28, 0x10,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x40, 0x80, 0xF8, 0xF0, 0xE0,
            0xC0, 0x80, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x80, 0x00,
            0x80, 0x80, 0x00, 0x40, 0xE0, 0x80,
            0xC0, 0xE0, 0xC0, 0xC6, 0xF0, 0xF8,
            0xBC, 0xC0, 0x00, 0x80, 0x00, 0x00,
            0x00, 0x00, 0xE0, 0xE0, 0x40, 0x00,
            0x00, 0x60, 0x30, 0xA0, 0x86, 0x02,
            0x70, 0xF4, 0xF0, 0xF3, 0xFB, 0x7B,
            0x08, 0x08, 0x07, 0x87, 0xC3, 0xC3,
            0xEF, 0xF9, 0x79, 0x9F, 0x9E, 0xBE,
            0x9C, 0xC8, 0xE8, 0xD8, 0xD0, 0xE0,
            0x20, 0xB0, 0xC0, 0x80, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0xE0, 0xA0, 0x38, 0x38,
            0xBC, 0x24, 0xC0, 0x02, 0x12, 0x00,
            0x18, 0x3C, 0x3C, 0x3F, 0x1F, 0x3F,
            0x35, 0x15, 0x07, 0x23, 0x31, 0x01,
            0x07, 0x05, 0x01, 0x0F, 0x0F, 0x0E,
            0x0C, 0x1C, 0x1C, 0x34, 0x34, 0x3E,
            0x6E, 0x27, 0x36, 0x24, 0x84, 0x07,
            0x07, 0x09, 0x0F, 0x0F, 0x0F, 0x0F,
            0x0E, 0x0E, 0x06, 0x0E, 0x07, 0x07,
            0x07, 0x17, 0x1D, 0x3C, 0x14, 0x1E,
            0x1F, 0xFF, 0x3C, 0x7C, 0xBF, 0xFF,
            0xBF, 0x7F, 0x7F, 0x3B, 0x6B, 0x6B,
            0x63, 0xFA, 0x33, 0x9F, 0x8E, 0xFC,
            0xE4, 0xFC, 0xE8, 0xE8, 0x30, 0xE0,
            0xC0, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x07, 0x19, 0x19, 0x0F, 0x26,
            0x40, 0x2E, 0x1D, 0x1F, 0x3F, 0x3E,
            0x3E, 0x7E, 0xFF, 0xFF, 0xCF, 0x00,
            0x18, 0x34, 0x32, 0xF0, 0x79, 0x7E,
            0xFE, 0xFE, 0xFC, 0xFC, 0xFC, 0xFC,
            0xF8, 0x3C, 0x12, 0x3E, 0xFC, 0xF8,
            0xFE, 0xC3, 0xC0, 0xFC, 0x83, 0x81,
            0x9C, 0x9E, 0xFF, 0xFE, 0xFA, 0xF4,
            0xFC, 0x8F, 0x9F, 0xFD, 0xFD, 0xFF,
            0xFE, 0xFE, 0xFE, 0xFE, 0xFF, 0xFE,
            0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFE,
            0xFE, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFF, 0x7F, 0x7F,
            0x3F, 0x07, 0x03, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x02, 0x07, 0x07, 0x0F,
            0x1C, 0x38, 0x39, 0x38, 0x3E, 0x1F,
            0x1F, 0x32, 0x3A, 0x18, 0x20, 0x62,
            0x42, 0xC0, 0x06, 0x0F, 0x3F, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFD, 0xFC, 0xC0,
            0xF8, 0xF1, 0xFD, 0xFF, 0xFF, 0xFF,
            0xFC, 0xFF, 0xFF, 0xFF, 0xFF, 0xE7,
            0xB9, 0x01, 0x01, 0x07, 0xE7, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFF, 0x73, 0x00,
            0x4F, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
            0x7F, 0x3F, 0x0F, 0x1F, 0x3F, 0x1F,
            0x0F, 0x0F, 0x0F, 0x07, 0x03, 0x01,
            0x01, 0x03, 0x07, 0x07, 0x03, 0x01,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x06, 0x03, 0x01, 0x01, 0x01, 0x01,
            0x01, 0x01, 0x01, 0x01, 0x01, 0x00,
            0x00, 0x07, 0x07, 0x03, 0x03, 0x0F,
            0x0F, 0x0F, 0x07, 0x1E, 0x24, 0x1C,
            0x0F, 0x0F, 0x07, 0x01, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x01, 0x01,
            0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00,
        };

        // Array of all bitmaps for convenience. (Total bytes used to store images in PROGMEM = 4160)
        const char* epd_bitmap_allArray[4] = {
            epd_bitmap_frame_0_delay_0,
            epd_bitmap_frame_1_delay_0,
            epd_bitmap_frame_2_delay_0,
            epd_bitmap_frame_3_delay_0
        };
     
        // Frame sizes array
        uint16_t frame_sizes[4] = {
            sizeof(epd_bitmap_frame_0_delay_0),
            sizeof(epd_bitmap_frame_1_delay_0),
            sizeof(epd_bitmap_frame_2_delay_0),
            sizeof(epd_bitmap_frame_3_delay_0)
        };

        // Run animation
        if (timer_elapsed(timer) > FRAME_DURATION) {
            timer = timer_read(); // Reset timer for next frame
            current_frame = (current_frame + 1) % (sizeof(epd_bitmap_allArray) / sizeof(epd_bitmap_allArray[0]));
            oled_write_raw_P(epd_bitmap_allArray[current_frame], frame_sizes[current_frame]);

        if (timer_elapsed32(anim_timer) > 600000) {
            // Animation ran for 5 seconds, stop and set off timer
            animation_enabled = false;
            oled_clear(); // Optionally clear the display or set a standby image
            anim_off_timer = timer_read32(); // Start off timer
        }
    }
    return true;
}
    
    
bool oled_task_user(void) {
    if (!is_oled_on()) return false; // exit early if the OLED is off

    // run animation at startup
    // animation_on();
    
    bool caps_lock_is_on = host_keyboard_led_state().caps_lock;
    static bool caps_lock_was_on = false; // Keep track of the caps lock state
    
    if (caps_lock_is_on != caps_lock_was_on) {
        caps_lock_was_on = caps_lock_is_on;
        if (caps_lock_is_on) {
            animation_enabled = false;
            oled_clear();
            static const unsigned char PROGMEM caps_active[] = {
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x80, 0xC0,
                0xE0, 0xF0, 0x70, 0xB0, 0xB0, 0xB0,
                0xB0, 0xB0, 0xB0, 0x70, 0xF0, 0xE0,
                0xC0, 0x80, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0xFE, 0xFF,
                0xFF, 0xF7, 0xFF, 0x06, 0x03, 0x01,
                0x01, 0x01, 0x01, 0x01, 0x01, 0x03,
                0x06, 0xFF, 0xF7, 0xFF, 0xFF, 0xFE,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0xE0, 0x70,
                0xD9, 0xD9, 0xF9, 0xD9, 0xD9, 0xD8,
                0xD8, 0xD8, 0xD8, 0xD8, 0xD8, 0xD8,
                0xD8, 0xD8, 0xD8, 0xD9, 0xD9, 0xF9,
                0xD9, 0xD9, 0x70, 0xE0, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
                0xFF, 0x1F, 0x0F, 0x07, 0x03, 0x03,
                0x03, 0x03, 0x07, 0x0F, 0x1F, 0xFF,
                0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0xFF, 0xFF, 0xFF, 0xFF,
                0xFF, 0xFF, 0xFF, 0xFF, 0xFE, 0xFC,
                0xF8, 0x00, 0x00, 0xF8, 0xFC, 0xFE,
                0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
                0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x03, 0x07,
                0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F,
                0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F,
                0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F,
                0x0F, 0x0F, 0x07, 0x03, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00,
            };
            oled_write_raw_P((const char *)caps_active, sizeof(caps_active));
    } else {
            //if (timer_elapsed32(anim_timer) < 5000) {
            // Caps Lock was on but now is off, clear the OLED or resume animation
            //caps_lock_was_on = false; // Update the flag
            oled_clear();
            animation_enabled=true;
            //return true;
    }
    //caps_lock_was_on = caps_lock_is_on; // Update state
    return true; // Skip further processing in this cycle
    }
    
    // Handle animation timing and control
    if (!animation_enabled && timer_elapsed32(anim_off_timer) > 1800000) {
        // Restart animation after 10-second off period
        oled_init(OLED_ROTATION_0);
        animation_enabled = true;
        anim_timer = timer_read32(); // Reset animation timer
        anim_off_timer = 0; // Clear off timer to avoid immediate restarts
        current_frame = 0; // Reset to the first frame
    }

    // Run or resume animation if enabled
    if (animation_enabled) {
        animation_on();
    }

    return true;            
}
#endif

void matrix_scan_user(void) {
    static uint8_t encoder_button_state = 0;
    if (readPin(KC_ENCODER_PUSH) == 0) {
        if (encoder_button_state == 0) {
            encoder_button_state = 1;
            tap_code(KC_MPLY); // temporary action for testing
            //uprintf("Encoder button pressed\n");
        }
    } else if (encoder_button_state == 1) {
        encoder_button_state = 0;
        //uprintf("Encoder button released\n");
    }
    
    //Turn RGB and OLED off when not in use
    if (timer_elapsed32(keyboard_idle_timer) > 300000) { // 5 minutes
        if (rgblight_is_enabled()) {
            rgblight_disable();
            oled_off();
        }
    }
}


bool process_record_user(uint16_t keycode, keyrecord_t *record) {    
      // Prints matrix position and status key pressed when console is enabled
    #ifdef CONSOLE_ENABLE
        uprintf("KL: kc: 0x%04X, row: %2u, col: %2u, pressed: %u, time: %5u, int: %u, count: %u\n", keycode, record->event.key.row, record->event.key.col, record->event.pressed, record->event.time, record->tap.interrupted, record->tap.count);
    #endif
    
    switch (keycode) {
        case PB_1:
            if (record->event.pressed) {
                if (!animation_enabled){
                    oled_init(OLED_ROTATION_0);
                    // Code to reset timers and initialize OLED as if the keyboard just started
                    keyboard_idle_timer = timer_read32(); // Reset idle timer
                    // Reset animation timers
                    anim_timer = timer_read32();
                    anim_off_timer = 0; // Clear off timer to ensure animation starts
                    animation_enabled = true; // Enable animation
                    current_frame = 0; // Start from the first frame
                    // Optionally, you might want to clear the OLED and restart the animation directly
                    oled_clear();
                    animation_on(); // Start the animation immediately
                    // Any additional initialization as performed in keyboard_post_init_user or similar
                }
                else{
                    animation_enabled = false;
                    oled_clear();
                    anim_off_timer = 0;
                    current_frame = 0;
                    }
            }
            return false; // Skip further processing to avoid standard keycode processing
    }
    
    // Turn RGB on when a key is pressed
    if (record->event.pressed) {
        keyboard_idle_timer = timer_read32();
        if (!rgblight_is_enabled()) {
            rgblight_enable();
        }
        if (!is_oled_on()) {
            oled_init(OLED_ROTATION_0);
            oled_on();
        }
    }
    return true;
}

void suspend_power_down_user(void) {
    // TODO when host computer is off
    oled_off();
    rgblight_disable();
}

void suspend_wakeup_init_user(void) {
    // TODO when host computer is back on
    oled_init(OLED_ROTATION_0);
    oled_on();
    rgblight_enable();
}




void keyboard_post_init_user(void) {
    // Delay for OLED power stabilization (Otherwise OLED won't start on cold boot (when unplugged and plugged back in) and will only work after being flashed and after pc reboot)
    wait_ms(100);
    // Enable NKRO from boot
    keymap_config.nkro = 1;
    // RGB starting state:
    rgblight_enable();
    rgblight_mode(6); // Sets the mode to rainbow
    // rgblight_sethsv(HSV_WHITE); // Sets the color to static white; To replace later
    
    // Initialize OLED
    anim_timer = timer_read32(); // Initialize the animation timer to the current time
    anim_off_timer = 0; // Ensure the off timer is reset

    // If you have specific setup for the animation, call it here
    // For example, you might reset the frame counter or perform other setup tasks
    current_frame = 0;
    oled_init(OLED_ROTATION_0); // OLED_ROTATION_180 if flipping the display
    oled_on();
}
