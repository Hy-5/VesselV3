// Copyright 2023 QMK
// SPDX-License-Identifier: GPL-2.0-or-later

#include QMK_KEYBOARD_H
#include "keymap_french.h"
#include "print.h"
#include "timer.h"


/***** rgblight_mode(mode)/rgblight_mode_noeeprom(mode) ****

SHOULD WORK with new name modes but for some reason won't compile unless I give it the number instead. Last time tested QMK 0.23.5

|-----------------|-----------------------------------|
| old mode number | new mode name                     |
|-----------------|-----------------------------------|
|        1        | RGBLIGHT_MODE_STATIC_LIGHT        |
|        2        | RGBLIGHT_MODE_BREATHING           |
|        3        | RGBLIGHT_MODE_BREATHING + 1       |
|        4        | RGBLIGHT_MODE_BREATHING + 2       |
|        5        | RGBLIGHT_MODE_BREATHING + 3       |
|        6        | RGBLIGHT_MODE_RAINBOW_MOOD        |
|        7        | RGBLIGHT_MODE_RAINBOW_MOOD + 1    |
|        8        | RGBLIGHT_MODE_RAINBOW_MOOD + 2    |
|        9        | RGBLIGHT_MODE_RAINBOW_SWIRL       |
|       10        | RGBLIGHT_MODE_RAINBOW_SWIRL + 1   |
|       11        | RGBLIGHT_MODE_RAINBOW_SWIRL + 2   |
|       12        | RGBLIGHT_MODE_RAINBOW_SWIRL + 3   |
|       13        | RGBLIGHT_MODE_RAINBOW_SWIRL + 4   |
|       14        | RGBLIGHT_MODE_RAINBOW_SWIRL + 5   |
|       15        | RGBLIGHT_MODE_SNAKE               |
|       16        | RGBLIGHT_MODE_SNAKE + 1           |
|       17        | RGBLIGHT_MODE_SNAKE + 2           |
|       18        | RGBLIGHT_MODE_SNAKE + 3           |
|       19        | RGBLIGHT_MODE_SNAKE + 4           |
|       20        | RGBLIGHT_MODE_SNAKE + 5           |
|       21        | RGBLIGHT_MODE_KNIGHT              |
|       22        | RGBLIGHT_MODE_KNIGHT + 1          |
|       23        | RGBLIGHT_MODE_KNIGHT + 2          |
|       24        | RGBLIGHT_MODE_CHRISTMAS           |
|       25        | RGBLIGHT_MODE_STATIC_GRADIENT     |
|       26        | RGBLIGHT_MODE_STATIC_GRADIENT + 1 |
|       27        | RGBLIGHT_MODE_STATIC_GRADIENT + 2 |
|       28        | RGBLIGHT_MODE_STATIC_GRADIENT + 3 |
|       29        | RGBLIGHT_MODE_STATIC_GRADIENT + 4 |
|       30        | RGBLIGHT_MODE_STATIC_GRADIENT + 5 |
|       31        | RGBLIGHT_MODE_STATIC_GRADIENT + 6 |
|       32        | RGBLIGHT_MODE_STATIC_GRADIENT + 7 |
|       33        | RGBLIGHT_MODE_STATIC_GRADIENT + 8 |
|       34        | RGBLIGHT_MODE_STATIC_GRADIENT + 9 |
|       35        | RGBLIGHT_MODE_RGB_TEST            |
|       36        | RGBLIGHT_MODE_ALTERNATING         |
|       37        | RGBLIGHT_MODE_TWINKLE             |
|       38        | RGBLIGHT_MODE_TWINKLE + 1         |
|       39        | RGBLIGHT_MODE_TWINKLE + 2         |
|       40        | RGBLIGHT_MODE_TWINKLE + 3         |
|       41        | RGBLIGHT_MODE_TWINKLE + 4         |
|       42        | RGBLIGHT_MODE_TWINKLE + 5         |
|-----------------|-----------------------------------|
 *****/
 
 static uint32_t keyboard_idle_timer = 0;


const uint16_t PROGMEM keymaps[][MATRIX_ROWS][MATRIX_COLS] = {
     
     /*
         *┌───┬───┐ ┌───┬───┐ ┌───┬───┐ ┌───┬───┐ ┌───┬───┐ ┌───┬───┐ ┌───┬───┬───┐
         *│M1 │M2 │ │M3 │M4 │ │M5 │M6 │ │M7 │M8 │ │M9 │M10│ │M11│M12│ │Pre│Pla│Nex│
         *└───┴───┘ └───┴───┘ └───┴───┘ └───┴───┘ └───┴───┘ └───┴───┘ └───┴───┴───┘
         *┌───┐ ┌───┬───┬───┬───┐ ┌───┬───┬───┬───┐ ┌───┬───┬───┬───┐ ┌───┬───┬───┐
         *│Esc│ │F1 │F2 │F3 │F4 │ │F5 │F6 │F7 │F8 │ │F9 │F10│F11│F12│ │PSc│OC │Lay│
         *└───┘ └───┴───┴───┴───┘ └───┴───┴───┴───┘ └───┴───┴───┴───┘ └───┴───┴───┘
         *┌───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───────┐   ┌───┬───┐
         *│ ² │ 1 │ 2 │ 3 │ 4 │ 5 │ 6 │ 7 │ 8 │ 9 │ 0 │ ° │ + │ Backsp│   │Hom│End│
         *├───┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─────┤   ├───┼───┤
         *│ Tab │ A │ Z │ E │ R │ T │ Y │ U │ I │ O │ P │ ¨ │ £ │     │   │Ins│PUp│
         *├─────┴┬──┴┬──┴┬──┴┬──┴┬──┴┬──┴┬──┴┬──┴┬──┴┬──┴┬──┴┬──┴┐ Ent│   ├───┼───┤
         *│ Caps │ Q │ S │ D │ F │ G │ H │ J │ K │ L │ M │ % │ µ │    │   │Del│PDn│             
         *├────┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴─┬─┴───┴┬───┤   └───┼───┤   
         *│Shft│ > │ W │ X │ C │ V │ B │ N │ ? │ . │ / │ § │Shift │ ↑ │       │T22│
         *├────┼───┴┬──┴─┬─┴───┴───┴───┴───┴───┴──┬┴───┼───┴┬─┬───┼───┼───┐ ┌─┴───┤
         *│Ctrl│GUI │Alt │          Space         │Alt │Menu│ │ ← │ ↓ │ → │ │(Enc)│
         *└────┴────┴────┴────────────────────────┴────┴────┘ └───┴───┴───┘ └─────┘
         *
     */
     
     
        [0] = LAYOUT_all(
        KC_F13,           KC_F14,   KC_F15,   KC_F16,   KC_F17,   KC_F18,   KC_F19,   KC_F20,   KC_F21,   KC_F22,   KC_F23,  KC_F24,     KC_MPRV, KC_MPLY, KC_MNXT,
        KC_ESC,           KC_F1,   KC_F2,   KC_F3,   KC_F4,   KC_F5,   KC_F6,   KC_F7,   KC_F8,   KC_F9,   KC_F10,  KC_F11,  KC_F12,     KC_PSCR, PB_1, PB_2,
        KC_GRV,  KC_1,    KC_2,    KC_3,    KC_4,    KC_5,    KC_6,    KC_7,    KC_8,    KC_9,    KC_0,    KC_MINS, KC_EQL,  KC_BSPC,    KC_HOME, KC_END,
        KC_TAB,  KC_Q,    KC_W,    KC_E,    KC_R,    KC_T,    KC_Y,    KC_U,    KC_I,    KC_O,    KC_P,    KC_LBRC, KC_RBRC, KC_ENT,     KC_INS,  KC_PGUP,
        KC_CAPS, KC_A,    KC_S,    KC_D,    KC_F,    KC_G,    KC_H,    KC_J,    KC_K,    KC_L,    KC_SCLN, KC_QUOT, KC_NUHS,             KC_DEL,  KC_PGDN,
        KC_LSFT, KC_NUBS, KC_Z,    KC_X,    KC_C,    KC_V,    KC_B,    KC_N,    KC_M,    KC_COMM, KC_DOT,  KC_SLSH, KC_RSFT,  KC_UP,              PB_3,
        KC_LCTL, KC_LGUI, KC_LALT,                            KC_SPC,                             KC_RALT, KC_APP,  KC_LEFT, KC_DOWN, KC_RGHT
    )
};


#if defined(ENCODER_MAP_ENABLE)
bool encoder_update_user(uint8_t index, bool clockwise) {
    if (index == 0) {
        if (clockwise) {
            uprintf("Encoder turned clockwise\n");
            tap_code(KC_VOLU); // temporary action for testing
        } else {
            uprintf("Encoder turned counter-clockwise\n");
            tap_code(KC_VOLD); // temporary action for testing
        }
    }
    return true;
}
#endif

#ifdef OLED_ENABLE
    
// Animation parameters
#define FRAME_DURATION 500 // How long each frame lasts in milliseconds

// Animation variables
uint32_t timer = 0;
uint8_t current_frame = 0;
static bool animation_enabled = true;

// animation rendering
bool animation_on(void) {
    if (!animation_enabled){
        return false;
    }
        // 'frame_0_delay-0', 128x64px
        static const char epd_bitmap_frame_0_delay_0 [] PROGMEM = {
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x80, 0xC0, 0x40,
            0x20, 0x20, 0x18, 0x18, 0x18, 0x18,
            0x08, 0x06, 0x02, 0x01, 0x01, 0x81,
            0x81, 0x83, 0x86, 0x8E, 0x8E, 0x1E,
            0x1E, 0x3C, 0x7C, 0x78, 0x78, 0xF0,
            0xE0, 0xE0, 0xC0, 0x80, 0x80, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
            0x80, 0x80, 0x40, 0x40, 0x40, 0x40,
            0xC0, 0xF0, 0xF8, 0xF8, 0xB8, 0xC8,
            0xFC, 0xFC, 0x7C, 0x3C, 0x1C, 0x0C,
            0x8E, 0xCE, 0xFA, 0x7A, 0x3A, 0x1A,
            0x0A, 0x02, 0x02, 0x82, 0x84, 0x8C,
            0x8C, 0x34, 0x34, 0x34, 0x64, 0xC4,
            0xC4, 0x9C, 0x3C, 0xFA, 0xFA, 0x71,
            0x70, 0x30, 0x24, 0x04, 0x0C, 0x38,
            0x72, 0x02, 0x06, 0x06, 0x04, 0x04,
            0x0C, 0x09, 0x31, 0x01, 0x03, 0x03,
            0x03, 0x03, 0x06, 0x0C, 0x38, 0x00,
            0x02, 0x0D, 0x1D, 0x71, 0xF3, 0x83,
            0x07, 0x0F, 0x06, 0x0E, 0x1C, 0xF0,
            0xC0, 0x80, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0xE0, 0x18,
            0x07, 0x07, 0x83, 0x00, 0x00, 0x08,
            0x08, 0x08, 0x9C, 0x9C, 0xFF, 0xEF,
            0xE7, 0x73, 0x7B, 0x7C, 0xFC, 0xFC,
            0xF7, 0xF7, 0xF3, 0x73, 0x18, 0x18,
            0x18, 0x1C, 0x0C, 0x0E, 0x03, 0x83,
            0x80, 0xF0, 0xF8, 0xC1, 0xFC, 0xFC,
            0x00, 0x00, 0xF0, 0x83, 0x07, 0x18,
            0x7F, 0x7F, 0xFE, 0xF8, 0xE0, 0x84,
            0x1C, 0xF8, 0xF0, 0xC0, 0x00, 0x00,
            0x04, 0xFC, 0xF8, 0x00, 0x00, 0xFF,
            0xFC, 0xC0, 0x80, 0x00, 0x00, 0x7F,
            0xFC, 0xFC, 0xC0, 0x00, 0x00, 0xE0,
            0xFF, 0xFF, 0xF8, 0x00, 0xE0, 0xFF,
            0xFF, 0xF0, 0x87, 0x7F, 0xFE, 0xF0,
            0x80, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
            0xC0, 0x60, 0x30, 0x18, 0x1C, 0x1F,
            0x3C, 0x78, 0xF0, 0xE0, 0x83, 0xC3,
            0xFF, 0xFE, 0xDE, 0x03, 0x01, 0xC0,
            0xC0, 0x40, 0x00, 0x00, 0x00, 0x42,
            0x62, 0x63, 0x3F, 0x3F, 0xFF, 0xFF,
            0xFE, 0xBA, 0xBA, 0x1A, 0x18, 0x10,
            0x00, 0x00, 0x19, 0x21, 0x63, 0x03,
            0x47, 0x4F, 0x1C, 0x3C, 0xFF, 0x3F,
            0x04, 0x00, 0x00, 0x00, 0x00, 0xFC,
            0x7F, 0x1F, 0x03, 0x07, 0x1F, 0x7F,
            0xF8, 0xF3, 0xE7, 0xCF, 0x1F, 0x7E,
            0x00, 0x03, 0x1F, 0xFF, 0xFF, 0xF8,
            0x00, 0x00, 0x03, 0x1F, 0x0F, 0x00,
            0x00, 0x00, 0x7F, 0x1F, 0x03, 0x00,
            0x00, 0x7F, 0x7F, 0x1F, 0x01, 0xF8,
            0xFF, 0xFF, 0xFF, 0xF0, 0xE0, 0x80,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x80, 0xC0, 0x78, 0x0C,
            0x07, 0x07, 0x0F, 0x1C, 0x3C, 0xF8,
            0x04, 0x32, 0x7A, 0x72, 0xE3, 0xC3,
            0x0F, 0x3F, 0x0F, 0x03, 0xF1, 0x7E,
            0x0F, 0x03, 0xC0, 0xE0, 0xF0, 0x38,
            0x00, 0x00, 0x00, 0x00, 0x08, 0x08,
            0x07, 0x47, 0x3F, 0x0F, 0x0F, 0x0B,
            0x00, 0x00, 0x00, 0x40, 0xC0, 0xC0,
            0x70, 0x00, 0x00, 0x00, 0x03, 0x38,
            0xC1, 0x06, 0xF8, 0x00, 0x00, 0x02,
            0x02, 0x00, 0x00, 0x00, 0x80, 0xC0,
            0xC0, 0x60, 0x70, 0x71, 0x79, 0x7B,
            0x7E, 0x7C, 0x70, 0xF0, 0xFE, 0xDF,
            0x8F, 0x00, 0x80, 0xC0, 0xF8, 0xFE,
            0x00, 0x00, 0x00, 0x80, 0xC0, 0xF8,
            0x7E, 0x00, 0x00, 0x80, 0xC0, 0x70,
            0x3F, 0x1F, 0x3F, 0x7F, 0xFF, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFC, 0xFC, 0xF8,
            0xF8, 0xF0, 0xF0, 0xF0, 0xF0, 0xE0,
            0xE0, 0xE0, 0xC0, 0x80, 0x80, 0x80,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x80, 0x80, 0xF8, 0x7F, 0x07,
            0x00, 0x10, 0x10, 0x18, 0x18, 0x18,
            0x38, 0x78, 0xF1, 0xF6, 0xF8, 0xF8,
            0xF8, 0xF0, 0x00, 0x00, 0x00, 0x00,
            0x87, 0x00, 0x00, 0xE0, 0x83, 0x07,
            0x00, 0x00, 0x00, 0x10, 0x10, 0x30,
            0x30, 0x30, 0x18, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x08, 0x00, 0x18, 0x0F, 0x06,
            0x40, 0x38, 0x00, 0xDF, 0x28, 0x01,
            0x6E, 0x60, 0x20, 0x10, 0x10, 0x11,
            0x01, 0xE0, 0xC0, 0x80, 0x00, 0x00,
            0x08, 0x08, 0x10, 0x30, 0xE0, 0xC0,
            0x01, 0x0F, 0x0F, 0xFF, 0xFF, 0xFF,
            0x7F, 0x7F, 0x7E, 0x7F, 0x7F, 0x7F,
            0x7F, 0x79, 0x1E, 0x06, 0x03, 0x01,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x01, 0x03, 0x03, 0x07,
            0x07, 0x0F, 0x0F, 0x0F, 0x0F, 0x9F,
            0x9F, 0xFF, 0xFF, 0xFF, 0xE7, 0x11,
            0x19, 0x19, 0x19, 0x19, 0xFE, 0xF8,
            0xF0, 0x1C, 0x02, 0x01, 0x01, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x01, 0xC3, 0xFF, 0x3F, 0x78, 0xF0,
            0x80, 0x00, 0x3F, 0x7C, 0x60, 0x87,
            0x1F, 0x3F, 0x3C, 0x00, 0x0F, 0x0E,
            0x1C, 0x18, 0x00, 0x00, 0x00, 0x02,
            0x00, 0x00, 0x00, 0x00, 0x80, 0x80,
            0x80, 0x80, 0xC0, 0xC0, 0xE0, 0x00,
            0x00, 0x00, 0x00, 0xC0, 0xC0, 0xC0,
            0xE0, 0xE0, 0xE6, 0x90, 0x80, 0x81,
            0x80, 0x40, 0x40, 0x40, 0x5F, 0x61,
            0x20, 0x30, 0x10, 0x18, 0x1C, 0x0C,
            0x0C, 0x06, 0x03, 0x02, 0x02, 0x01,
            0x00, 0x00, 0x00, 0x00, 0xC0, 0xA0,
            0x3C, 0x0C, 0x0C, 0x0C, 0x0C, 0x18,
            0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
            0x18, 0x38, 0x78, 0xF8, 0xF8, 0xFC,
            0xCC, 0x0C, 0x0C, 0x0E, 0xBE, 0xFE,
            0xFD, 0xF1, 0x61, 0x40, 0x20, 0x11,
            0x1F, 0x1F, 0x0E, 0x0E, 0x0E, 0x02,
            0x01, 0x00, 0x1F, 0x7C, 0x3E, 0x30,
            0x30, 0xF0, 0xF8, 0x7C, 0x60, 0x60,
            0xF8, 0xFC, 0x7C, 0x18, 0x1C, 0x18,
            0x1C, 0x3C, 0x03, 0x01, 0x00, 0x00,
            0x00, 0x00, 0x07, 0x04, 0x18, 0x18,
            0x18, 0x18, 0x0C, 0x04, 0x04, 0x18,
            0x18, 0x18, 0x04, 0x04, 0x04, 0x0C,
            0x18, 0x30, 0x30, 0x60, 0x60, 0x60,
            0x60, 0x61, 0x63, 0x63, 0x73, 0x6F,
            0x6B, 0x38, 0x18, 0x08, 0x06, 0x03,
            0x01, 0x01, 0x01, 0x01, 0x01, 0x01,
            0x01, 0x01, 0x01, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x01, 0x03, 0x03, 0x03, 0x04,
            0x04, 0x04, 0x04, 0x04, 0x04, 0x04,
            0x04, 0x04, 0x04, 0x04, 0x04, 0x07,
            0x07, 0x07, 0x03, 0x03, 0x03, 0x03,
            0x01, 0x01, 0x01, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00,
        };
        // 'frame_1_delay-0', 128x64px
        static const char epd_bitmap_frame_1_delay_0 [] PROGMEM = {
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x80, 0xC0, 0x40,
            0x20, 0x20, 0x18, 0x18, 0x18, 0x18,
            0x08, 0x06, 0x02, 0x01, 0x01, 0x81,
            0x81, 0x83, 0x86, 0x8E, 0x8E, 0x1E,
            0x1E, 0x3C, 0x7C, 0x78, 0x78, 0xF0,
            0xE0, 0xE0, 0xC0, 0x80, 0x80, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
            0x80, 0x80, 0x40, 0x40, 0x40, 0x40,
            0xC0, 0xF0, 0xF8, 0xF8, 0xB8, 0xC8,
            0xFC, 0xFC, 0x7C, 0x3C, 0x1C, 0x0C,
            0x8E, 0xCE, 0xFA, 0x7A, 0x3A, 0x1A,
            0x0A, 0x02, 0x02, 0x02, 0x04, 0x0C,
            0x0C, 0x34, 0x34, 0x34, 0x64, 0xC4,
            0xC4, 0x9C, 0x3C, 0xFA, 0xFA, 0x71,
            0x70, 0x30, 0x24, 0x04, 0x0C, 0x38,
            0x72, 0x02, 0x06, 0x06, 0x04, 0x04,
            0x0C, 0x09, 0x31, 0x01, 0x03, 0x03,
            0x03, 0x03, 0x06, 0x0C, 0x38, 0x00,
            0x02, 0x0D, 0x1D, 0x71, 0xF3, 0x83,
            0x07, 0x0F, 0x06, 0x0E, 0x1C, 0xF0,
            0xC0, 0x80, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0xE0, 0x18,
            0x07, 0x07, 0x83, 0x00, 0x00, 0x08,
            0x08, 0x08, 0x9C, 0x9C, 0xFF, 0xEF,
            0xE7, 0x73, 0x7B, 0x7C, 0xFC, 0xFC,
            0xF7, 0xF7, 0xF3, 0x73, 0x18, 0x18,
            0x18, 0x18, 0x08, 0x0C, 0x0E, 0x87,
            0x83, 0xE3, 0xF3, 0x04, 0xF8, 0xF8,
            0x00, 0x00, 0xF0, 0x83, 0x07, 0x18,
            0x7F, 0x7F, 0xFE, 0xF8, 0xE0, 0x84,
            0x1C, 0xF8, 0xF0, 0xC0, 0x00, 0x00,
            0x04, 0xFC, 0xF8, 0x00, 0x00, 0xFF,
            0xFC, 0xC0, 0x80, 0x00, 0x00, 0x7F,
            0xFC, 0xFC, 0xC0, 0x00, 0x00, 0xE0,
            0xFF, 0xFF, 0xF8, 0x00, 0xE0, 0xFF,
            0xFF, 0xF0, 0x87, 0x7F, 0xFE, 0xF0,
            0x80, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
            0xC0, 0x60, 0x30, 0x18, 0x1C, 0x1F,
            0x3C, 0x78, 0xF0, 0xE0, 0x83, 0xC3,
            0xFF, 0xFE, 0xDE, 0x03, 0x01, 0xC0,
            0xC0, 0x40, 0x00, 0x00, 0x00, 0x42,
            0x62, 0x63, 0x3F, 0x3F, 0xFF, 0xFF,
            0xFE, 0xBA, 0xBA, 0x1A, 0x18, 0x10,
            0x00, 0x00, 0x19, 0x21, 0x63, 0x03,
            0x47, 0x4F, 0x1C, 0x3C, 0xFF, 0x3F,
            0x04, 0x00, 0x00, 0x00, 0x00, 0xFC,
            0x7F, 0x1F, 0x03, 0x07, 0x1F, 0x7F,
            0xF8, 0xF3, 0xE7, 0xCF, 0x1F, 0x7E,
            0x00, 0x03, 0x1F, 0xFF, 0xFF, 0xF8,
            0x00, 0x00, 0x03, 0x1F, 0x0F, 0x00,
            0x00, 0x00, 0x7F, 0x1F, 0x03, 0x00,
            0x00, 0x7F, 0x7F, 0x1F, 0x01, 0xF8,
            0xFF, 0xFF, 0xFF, 0xF0, 0xE0, 0x80,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x80, 0xC0, 0x78, 0x0C,
            0x07, 0x07, 0x0F, 0x1C, 0x3C, 0xF0,
            0x08, 0x44, 0xF4, 0xC4, 0xC7, 0x8F,
            0x1F, 0x3F, 0x0F, 0x03, 0xF1, 0x7E,
            0x0F, 0x03, 0xC0, 0xE0, 0xF0, 0x38,
            0x00, 0x00, 0x00, 0x00, 0x08, 0x08,
            0x07, 0x47, 0x3F, 0x0F, 0x0F, 0x0B,
            0x00, 0x00, 0x00, 0x40, 0xC0, 0xC0,
            0x70, 0x00, 0x00, 0x00, 0x03, 0x38,
            0xC1, 0x06, 0xF8, 0x00, 0x00, 0x02,
            0x02, 0x00, 0x00, 0x00, 0x80, 0xC0,
            0xC0, 0x60, 0x70, 0x71, 0x79, 0x7B,
            0x7E, 0x7C, 0x70, 0xF0, 0xFE, 0xDF,
            0x8F, 0x00, 0x80, 0xC0, 0xF8, 0xFE,
            0x00, 0x00, 0x00, 0x80, 0xC0, 0xF8,
            0x7E, 0x00, 0x00, 0x80, 0xC0, 0x70,
            0x3F, 0x1F, 0x3F, 0x7F, 0xFF, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFC, 0xFC, 0xF8,
            0xF8, 0xF0, 0xF0, 0xF0, 0xF0, 0xE0,
            0xE0, 0xE0, 0xE0, 0xC0, 0x80, 0x80,
            0x80, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x80, 0x80, 0xF8, 0x7F, 0x07,
            0x00, 0x10, 0x10, 0x18, 0x18, 0x18,
            0x38, 0x71, 0xF6, 0xF8, 0xF0, 0xF0,
            0xF1, 0xF1, 0x00, 0x00, 0x00, 0x00,
            0x87, 0x00, 0x00, 0xE0, 0x83, 0x07,
            0x00, 0x00, 0x00, 0x10, 0x10, 0x30,
            0x30, 0x30, 0x18, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x08, 0x00, 0x18, 0x0F, 0x06,
            0x40, 0x38, 0x00, 0xDF, 0x28, 0x01,
            0x6E, 0x60, 0x20, 0x10, 0x10, 0x11,
            0x01, 0xE0, 0xC0, 0x80, 0x00, 0x00,
            0x08, 0x08, 0x10, 0x30, 0xE0, 0xC0,
            0x01, 0x0F, 0x0F, 0xFF, 0xFF, 0xFF,
            0x7F, 0x7F, 0x7E, 0x7F, 0x7F, 0x7F,
            0x7F, 0x79, 0x1E, 0x06, 0x03, 0x01,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x01, 0x03, 0x03, 0x07,
            0x07, 0x07, 0x0F, 0x8F, 0x8F, 0xCF,
            0xFF, 0xFF, 0xFF, 0xE7, 0x17, 0x19,
            0x19, 0x19, 0x1B, 0xFE, 0xF8, 0x00,
            0xF0, 0x1C, 0x02, 0x01, 0x01, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x01, 0xC3, 0xFF, 0x3F, 0x78, 0xF0,
            0x80, 0x00, 0x3F, 0x7C, 0x60, 0x87,
            0x1F, 0x3F, 0x3C, 0x00, 0x0F, 0x0E,
            0x1C, 0x18, 0x00, 0x00, 0x00, 0x02,
            0x00, 0x00, 0x00, 0x00, 0x80, 0x80,
            0x80, 0x80, 0xC0, 0xC0, 0xE0, 0x00,
            0x00, 0x00, 0x00, 0xC0, 0xC0, 0xC0,
            0xE0, 0xE0, 0xE6, 0x90, 0x80, 0x81,
            0x80, 0x40, 0x40, 0x40, 0x5F, 0x61,
            0x20, 0x30, 0x10, 0x18, 0x1C, 0x0C,
            0x0C, 0x06, 0x03, 0x02, 0x02, 0x01,
            0x00, 0x00, 0x00, 0x80, 0x40, 0x38,
            0x38, 0x18, 0x18, 0x18, 0x18, 0x18,
            0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
            0x38, 0x78, 0xF8, 0xF8, 0xEC, 0xCC,
            0x0C, 0x0C, 0x0E, 0xBE, 0xFE, 0xFD,
            0xF1, 0x60, 0x40, 0x20, 0x19, 0x1F,
            0x1F, 0x0E, 0x0E, 0x06, 0x02, 0x01,
            0x00, 0x00, 0x1F, 0x7C, 0x3E, 0x30,
            0x30, 0xF0, 0xF8, 0x7C, 0x60, 0x60,
            0xF8, 0xFC, 0x7C, 0x18, 0x1C, 0x18,
            0x1C, 0x3C, 0x03, 0x01, 0x00, 0x00,
            0x00, 0x00, 0x07, 0x04, 0x18, 0x18,
            0x18, 0x18, 0x0C, 0x04, 0x04, 0x18,
            0x18, 0x18, 0x04, 0x04, 0x04, 0x0C,
            0x18, 0x30, 0x30, 0x60, 0x60, 0x60,
            0x60, 0x61, 0x63, 0x63, 0x73, 0x6F,
            0x6B, 0x38, 0x18, 0x08, 0x06, 0x03,
            0x01, 0x01, 0x01, 0x01, 0x01, 0x01,
            0x01, 0x01, 0x01, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x03,
            0x03, 0x04, 0x04, 0x04, 0x04, 0x04,
            0x04, 0x04, 0x04, 0x04, 0x04, 0x04,
            0x04, 0x04, 0x04, 0x04, 0x07, 0x07,
            0x07, 0x03, 0x03, 0x03, 0x03, 0x01,
            0x01, 0x01, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00,
        };
        // 'frame_2_delay-0', 128x64px
        static const char epd_bitmap_frame_2_delay_0 [] PROGMEM = {
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x80, 0xC0, 0x40,
            0x20, 0x20, 0x18, 0x18, 0x18, 0x18,
            0x08, 0x06, 0x02, 0x01, 0x01, 0x81,
            0x81, 0x83, 0x86, 0x8E, 0x8E, 0x1E,
            0x1E, 0x3C, 0x7C, 0x78, 0x78, 0xF0,
            0xE0, 0xE0, 0xC0, 0x80, 0x80, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
            0x80, 0x80, 0x40, 0x40, 0x40, 0x40,
            0xC0, 0xF0, 0xF8, 0xF8, 0xB8, 0xC8,
            0xFC, 0xFC, 0x7C, 0x3C, 0x1C, 0x0C,
            0x8E, 0xCE, 0xFA, 0x7A, 0x3A, 0x1A,
            0x0A, 0x02, 0x02, 0x82, 0x84, 0x8C,
            0x8C, 0x34, 0x34, 0x34, 0x64, 0xC4,
            0xC4, 0x9C, 0x3C, 0xFA, 0xFA, 0x71,
            0x70, 0x30, 0x24, 0x04, 0x0C, 0x38,
            0x72, 0x02, 0x06, 0x06, 0x04, 0x04,
            0x0C, 0x09, 0x31, 0x01, 0x03, 0x03,
            0x03, 0x03, 0x06, 0x0C, 0x38, 0x00,
            0x02, 0x0D, 0x1D, 0x71, 0xF3, 0x83,
            0x07, 0x0F, 0x06, 0x0E, 0x1C, 0xF0,
            0xC0, 0x80, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0xE0, 0x18,
            0x07, 0x07, 0x83, 0x00, 0x00, 0x08,
            0x08, 0x08, 0x9C, 0x9C, 0xFF, 0xEF,
            0xE7, 0x73, 0x7B, 0x7C, 0xFC, 0xFC,
            0xF7, 0xF7, 0xF3, 0x73, 0x18, 0x18,
            0x18, 0x1C, 0x0C, 0x0E, 0x03, 0x83,
            0x80, 0xF0, 0xF8, 0xC1, 0xFC, 0xFC,
            0x00, 0x00, 0xF0, 0x83, 0x07, 0x18,
            0x7F, 0x7F, 0xFE, 0xF8, 0xE0, 0x84,
            0x1C, 0xF8, 0xF0, 0xC0, 0x00, 0x00,
            0x04, 0xFC, 0xF8, 0x00, 0x00, 0xFF,
            0xFC, 0xC0, 0x80, 0x00, 0x00, 0x7F,
            0xFC, 0xFC, 0xC0, 0x00, 0x00, 0xE0,
            0xFF, 0xFF, 0xF8, 0x00, 0xE0, 0xFF,
            0xFF, 0xF0, 0x87, 0x7F, 0xFE, 0xF0,
            0x80, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
            0xC0, 0x60, 0x30, 0x18, 0x1C, 0x1F,
            0x3C, 0x78, 0xF0, 0xE0, 0x83, 0xC3,
            0xFF, 0xFE, 0xDE, 0x03, 0x01, 0xC0,
            0xC0, 0x40, 0x00, 0x00, 0x00, 0x42,
            0x62, 0x63, 0x3F, 0x3F, 0xFF, 0xFF,
            0xFE, 0xBA, 0xBA, 0x1A, 0x18, 0x10,
            0x00, 0x00, 0x19, 0x21, 0x63, 0x03,
            0x47, 0x4F, 0x1C, 0x3C, 0xFF, 0x3F,
            0x04, 0x00, 0x00, 0x00, 0x00, 0xFC,
            0x7F, 0x1F, 0x03, 0x07, 0x1F, 0x7F,
            0xF8, 0xF3, 0xE7, 0xCF, 0x1F, 0x7E,
            0x00, 0x03, 0x1F, 0xFF, 0xFF, 0xF8,
            0x00, 0x00, 0x03, 0x1F, 0x0F, 0x00,
            0x00, 0x00, 0x7F, 0x1F, 0x03, 0x00,
            0x00, 0x7F, 0x7F, 0x1F, 0x01, 0xF8,
            0xFF, 0xFF, 0xFF, 0xF0, 0xE0, 0x80,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x80, 0xC0, 0x78, 0x0C,
            0x07, 0x07, 0x0F, 0x1C, 0x3C, 0xF8,
            0x04, 0x32, 0x7A, 0x72, 0xE3, 0xC3,
            0x0F, 0x3F, 0x0F, 0x03, 0xF1, 0x7E,
            0x0F, 0x03, 0xC0, 0xE0, 0xF0, 0x38,
            0x00, 0x00, 0x00, 0x00, 0x08, 0x08,
            0x07, 0x47, 0x3F, 0x0F, 0x0F, 0x0B,
            0x00, 0x00, 0x00, 0x40, 0xC0, 0xC0,
            0x70, 0x00, 0x00, 0x00, 0x03, 0x38,
            0xC1, 0x06, 0xF8, 0x00, 0x00, 0x02,
            0x02, 0x00, 0x00, 0x00, 0x80, 0xC0,
            0xC0, 0x60, 0x70, 0x71, 0x79, 0x7B,
            0x7E, 0x7C, 0x70, 0xF0, 0xFE, 0xDF,
            0x8F, 0x00, 0x80, 0xC0, 0xF8, 0xFE,
            0x00, 0x00, 0x00, 0x80, 0xC0, 0xF8,
            0x7E, 0x00, 0x00, 0x80, 0xC0, 0x70,
            0x3F, 0x1F, 0x3F, 0x7F, 0xFF, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFC, 0xFC, 0xF8,
            0xF8, 0xF0, 0xF0, 0xF0, 0xF0, 0xE0,
            0xE0, 0xE0, 0xE0, 0xC0, 0x80, 0x80,
            0x80, 0x80, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x80, 0x80, 0xF8, 0x7F, 0x07,
            0x00, 0x10, 0x10, 0x18, 0x18, 0x18,
            0x38, 0x78, 0xF1, 0xF6, 0xF8, 0xF8,
            0xF8, 0xF0, 0x00, 0x00, 0x00, 0x00,
            0x87, 0x00, 0x00, 0xE0, 0x83, 0x07,
            0x00, 0x00, 0x00, 0x10, 0x10, 0x30,
            0x30, 0x30, 0x18, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x08, 0x00, 0x18, 0x0F, 0x06,
            0x40, 0x38, 0x00, 0xDF, 0x28, 0x01,
            0x6E, 0x60, 0x20, 0x10, 0x10, 0x11,
            0x01, 0xE0, 0xC0, 0x80, 0x00, 0x00,
            0x08, 0x08, 0x10, 0x30, 0xE0, 0xC0,
            0x01, 0x0F, 0x0F, 0xFF, 0xFF, 0xFF,
            0x7F, 0x7F, 0x7E, 0x7F, 0x7F, 0x7F,
            0x7F, 0x79, 0x1E, 0x06, 0x03, 0x01,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x01, 0x03, 0x03, 0x07,
            0x07, 0x87, 0x8F, 0x8F, 0xCF, 0xCF,
            0x7F, 0x7F, 0xFF, 0xFF, 0xE7, 0x17,
            0x1B, 0x19, 0x19, 0x99, 0xFE, 0xF8,
            0xF0, 0x1C, 0x02, 0x01, 0x01, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x01, 0xC3, 0xFF, 0x3F, 0x78, 0xF0,
            0x80, 0x00, 0x3F, 0x7C, 0x60, 0x87,
            0x1F, 0x3F, 0x3C, 0x00, 0x0F, 0x0E,
            0x1C, 0x18, 0x00, 0x00, 0x00, 0x02,
            0x00, 0x00, 0x00, 0x00, 0x80, 0x80,
            0x80, 0x80, 0xC0, 0xC0, 0xE0, 0x00,
            0x00, 0x00, 0x00, 0xC0, 0xC0, 0xC0,
            0xE0, 0xE0, 0xE6, 0x90, 0x80, 0x81,
            0x80, 0x40, 0x40, 0x40, 0x5F, 0x61,
            0x20, 0x30, 0x10, 0x18, 0x1C, 0x0C,
            0x0C, 0x06, 0x03, 0x02, 0x02, 0x01,
            0x00, 0x00, 0x00, 0x00, 0x60, 0xB0,
            0x30, 0x18, 0x18, 0x0C, 0x0C, 0x0C,
            0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C,
            0x0C, 0x1C, 0x3C, 0xFC, 0xFC, 0xFE,
            0xE2, 0x82, 0x82, 0x83, 0xDF, 0x7F,
            0x7E, 0x78, 0x30, 0x20, 0x18, 0x0C,
            0x0E, 0x0F, 0x07, 0x03, 0x03, 0x01,
            0x01, 0x00, 0x1F, 0x7C, 0x3E, 0x30,
            0x30, 0xF0, 0xF8, 0x7C, 0x60, 0x60,
            0xF8, 0xFC, 0x7C, 0x18, 0x1C, 0x18,
            0x1C, 0x3C, 0x03, 0x01, 0x00, 0x00,
            0x00, 0x00, 0x07, 0x04, 0x18, 0x18,
            0x18, 0x18, 0x0C, 0x04, 0x04, 0x18,
            0x18, 0x18, 0x04, 0x04, 0x04, 0x0C,
            0x18, 0x30, 0x30, 0x60, 0x60, 0x60,
            0x60, 0x61, 0x63, 0x63, 0x73, 0x6F,
            0x6B, 0x38, 0x18, 0x08, 0x06, 0x03,
            0x01, 0x01, 0x01, 0x01, 0x01, 0x01,
            0x01, 0x01, 0x01, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x07, 0x06, 0x04, 0x04,
            0x04, 0x02, 0x03, 0x03, 0x03, 0x03,
            0x03, 0x03, 0x03, 0x03, 0x03, 0x03,
            0x03, 0x03, 0x01, 0x01, 0x01, 0x01,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00,
        };
        // 'frame_3_delay-0', 128x64px
        static const char epd_bitmap_frame_3_delay_0 [] PROGMEM = {
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x80, 0xC0, 0x40,
            0x20, 0x20, 0x18, 0x18, 0x18, 0x18,
            0x08, 0x06, 0x02, 0x01, 0x01, 0x81,
            0x81, 0x83, 0x86, 0x8E, 0x8E, 0x1E,
            0x1E, 0x3C, 0x7C, 0x78, 0x78, 0xF0,
            0xE0, 0xE0, 0xC0, 0x80, 0x80, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
            0x80, 0x80, 0x40, 0x40, 0x40, 0x40,
            0xC0, 0xF0, 0xF8, 0xF8, 0xB8, 0xC8,
            0xFC, 0xFC, 0x7C, 0x3C, 0x1C, 0x0C,
            0x8E, 0xCE, 0xFA, 0x7A, 0x3A, 0x1A,
            0x0A, 0x02, 0x02, 0x02, 0x04, 0x0C,
            0x0C, 0x34, 0x34, 0x34, 0x64, 0xC4,
            0xC4, 0x9C, 0x3C, 0xFA, 0xFA, 0x71,
            0x70, 0x30, 0x24, 0x04, 0x0C, 0x38,
            0x72, 0x02, 0x06, 0x06, 0x04, 0x04,
            0x0C, 0x09, 0x31, 0x01, 0x03, 0x03,
            0x03, 0x03, 0x06, 0x0C, 0x38, 0x00,
            0x02, 0x0D, 0x1D, 0x71, 0xF3, 0x83,
            0x07, 0x0F, 0x06, 0x0E, 0x1C, 0xF0,
            0xC0, 0x80, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0xE0, 0x18,
            0x07, 0x07, 0x83, 0x00, 0x00, 0x08,
            0x08, 0x08, 0x9C, 0x9C, 0xFF, 0xEF,
            0xE7, 0x73, 0x7B, 0x7C, 0xFC, 0xFC,
            0xF7, 0xF7, 0xF3, 0x73, 0x18, 0x18,
            0x18, 0x18, 0x08, 0x0C, 0x0E, 0x87,
            0x83, 0xE3, 0xF3, 0x04, 0xF8, 0xF8,
            0x00, 0x00, 0xF0, 0x83, 0x07, 0x18,
            0x7F, 0x7F, 0xFE, 0xF8, 0xE0, 0x84,
            0x1C, 0xF8, 0xF0, 0xC0, 0x00, 0x00,
            0x04, 0xFC, 0xF8, 0x00, 0x00, 0xFF,
            0xFC, 0xC0, 0x80, 0x00, 0x00, 0x7F,
            0xFC, 0xFC, 0xC0, 0x00, 0x00, 0xE0,
            0xFF, 0xFF, 0xF8, 0x00, 0xE0, 0xFF,
            0xFF, 0xF0, 0x87, 0x7F, 0xFE, 0xF0,
            0x80, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x80,
            0xC0, 0x60, 0x30, 0x18, 0x1C, 0x1F,
            0x3C, 0x78, 0xF0, 0xE0, 0x83, 0xC3,
            0xFF, 0xFE, 0xDE, 0x03, 0x01, 0xC0,
            0xC0, 0x40, 0x00, 0x00, 0x00, 0x42,
            0x62, 0x63, 0x3F, 0x3F, 0xFF, 0xFF,
            0xFE, 0xBA, 0xBA, 0x1A, 0x18, 0x10,
            0x00, 0x00, 0x19, 0x21, 0x63, 0x03,
            0x47, 0x4F, 0x1C, 0x3C, 0xFF, 0x3F,
            0x04, 0x00, 0x00, 0x00, 0x00, 0xFC,
            0x7F, 0x1F, 0x03, 0x07, 0x1F, 0x7F,
            0xF8, 0xF3, 0xE7, 0xCF, 0x1F, 0x7E,
            0x00, 0x03, 0x1F, 0xFF, 0xFF, 0xF8,
            0x00, 0x00, 0x03, 0x1F, 0x0F, 0x00,
            0x00, 0x00, 0x7F, 0x1F, 0x03, 0x00,
            0x00, 0x7F, 0x7F, 0x1F, 0x01, 0xF8,
            0xFF, 0xFF, 0xFF, 0xF0, 0xE0, 0x80,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x80, 0xC0, 0x78, 0x0C,
            0x07, 0x07, 0x0F, 0x1C, 0x3C, 0xF0,
            0x08, 0x44, 0xF4, 0xC4, 0xC7, 0x8F,
            0x1F, 0x3F, 0x0F, 0x03, 0xF1, 0x7E,
            0x0F, 0x03, 0xC0, 0xE0, 0xF0, 0x38,
            0x00, 0x00, 0x00, 0x00, 0x08, 0x08,
            0x07, 0x47, 0x3F, 0x0F, 0x0F, 0x0B,
            0x00, 0x00, 0x00, 0x40, 0xC0, 0xC0,
            0x70, 0x00, 0x00, 0x00, 0x03, 0x38,
            0xC1, 0x06, 0xF8, 0x00, 0x00, 0x02,
            0x02, 0x00, 0x00, 0x00, 0x80, 0xC0,
            0xC0, 0x60, 0x70, 0x71, 0x79, 0x7B,
            0x7E, 0x7C, 0x70, 0xF0, 0xFE, 0xDF,
            0x8F, 0x00, 0x80, 0xC0, 0xF8, 0xFE,
            0x00, 0x00, 0x00, 0x80, 0xC0, 0xF8,
            0x7E, 0x00, 0x00, 0x80, 0xC0, 0x70,
            0x3F, 0x1F, 0x3F, 0x7F, 0xFF, 0xFF,
            0xFF, 0xFF, 0xFF, 0xFC, 0xFC, 0xF8,
            0xF8, 0xF0, 0xF0, 0xF0, 0xF0, 0xE0,
            0xE0, 0xE0, 0xE0, 0xC0, 0x80, 0x80,
            0x80, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x80, 0x80, 0xF8, 0x7F, 0x07,
            0x00, 0x10, 0x10, 0x18, 0x18, 0x18,
            0x38, 0x71, 0xF6, 0xF8, 0xF0, 0xF0,
            0xF1, 0xF1, 0x00, 0x00, 0x00, 0x00,
            0x87, 0x00, 0x00, 0xE0, 0x83, 0x07,
            0x00, 0x00, 0x00, 0x10, 0x10, 0x30,
            0x30, 0x30, 0x18, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x08, 0x00, 0x18, 0x0F, 0x06,
            0x40, 0x38, 0x00, 0xDF, 0x28, 0x01,
            0x6E, 0x60, 0x20, 0x10, 0x10, 0x11,
            0x01, 0xE0, 0xC0, 0x80, 0x00, 0x00,
            0x08, 0x08, 0x10, 0x30, 0xE0, 0xC0,
            0x01, 0x0F, 0x0F, 0xFF, 0xFF, 0xFF,
            0x7F, 0x7F, 0x7E, 0x7F, 0x7F, 0x7F,
            0x7F, 0x79, 0x1E, 0x06, 0x03, 0x01,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x01, 0x03, 0x03, 0x07,
            0x07, 0x07, 0x0F, 0x8F, 0x8F, 0xCF,
            0xFF, 0xFF, 0xFF, 0xE7, 0x17, 0x19,
            0x19, 0x19, 0x1B, 0xFE, 0xF8, 0x00,
            0xF0, 0x1C, 0x02, 0x01, 0x01, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x01, 0xC3, 0xFF, 0x3F, 0x78, 0xF0,
            0x80, 0x00, 0x3F, 0x7C, 0x60, 0x87,
            0x1F, 0x3F, 0x3C, 0x00, 0x0F, 0x0E,
            0x1C, 0x18, 0x00, 0x00, 0x00, 0x02,
            0x00, 0x00, 0x00, 0x00, 0x80, 0x80,
            0x80, 0x80, 0xC0, 0xC0, 0xE0, 0x00,
            0x00, 0x00, 0x00, 0xC0, 0xC0, 0xC0,
            0xE0, 0xE0, 0xE6, 0x90, 0x80, 0x81,
            0x80, 0x40, 0x40, 0x40, 0x5F, 0x61,
            0x20, 0x30, 0x10, 0x18, 0x1C, 0x0C,
            0x0C, 0x06, 0x03, 0x02, 0x02, 0x01,
            0x00, 0x00, 0x00, 0x80, 0x40, 0x38,
            0x38, 0x18, 0x18, 0x18, 0x18, 0x18,
            0x18, 0x18, 0x18, 0x18, 0x18, 0x18,
            0x38, 0x78, 0xF8, 0xF8, 0xEC, 0xCC,
            0x0C, 0x0C, 0x0E, 0xBE, 0xFE, 0xFD,
            0xF1, 0x60, 0x40, 0x20, 0x19, 0x1F,
            0x1F, 0x0E, 0x0E, 0x06, 0x02, 0x01,
            0x00, 0x00, 0x1F, 0x7C, 0x3E, 0x30,
            0x30, 0xF0, 0xF8, 0x7C, 0x60, 0x60,
            0xF8, 0xFC, 0x7C, 0x18, 0x1C, 0x18,
            0x1C, 0x3C, 0x03, 0x01, 0x00, 0x00,
            0x00, 0x00, 0x07, 0x04, 0x18, 0x18,
            0x18, 0x18, 0x0C, 0x04, 0x04, 0x18,
            0x18, 0x18, 0x04, 0x04, 0x04, 0x0C,
            0x18, 0x30, 0x30, 0x60, 0x60, 0x60,
            0x60, 0x61, 0x63, 0x63, 0x73, 0x6F,
            0x6B, 0x38, 0x18, 0x08, 0x06, 0x03,
            0x01, 0x01, 0x01, 0x01, 0x01, 0x01,
            0x01, 0x01, 0x01, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x03,
            0x03, 0x04, 0x04, 0x04, 0x04, 0x04,
            0x04, 0x04, 0x04, 0x04, 0x04, 0x04,
            0x04, 0x04, 0x04, 0x04, 0x07, 0x07,
            0x07, 0x03, 0x03, 0x03, 0x03, 0x01,
            0x01, 0x01, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
            0x00, 0x00, 0x00, 0x00,
        };

        // Array of all bitmaps for convenience. (Total bytes used to store images in PROGMEM = 4160)
        const char* epd_bitmap_allArray[4] = {
            epd_bitmap_frame_0_delay_0,
            epd_bitmap_frame_1_delay_0,
            epd_bitmap_frame_2_delay_0,
            epd_bitmap_frame_3_delay_0
        };
     
        // Frame sizes array
        uint16_t frame_sizes[4] = {
            sizeof(epd_bitmap_frame_0_delay_0),
            sizeof(epd_bitmap_frame_1_delay_0),
            sizeof(epd_bitmap_frame_2_delay_0),
            sizeof(epd_bitmap_frame_3_delay_0)
        };

        // Run animation
        if (timer_elapsed(timer) > FRAME_DURATION) {
            // Set timer to updated time
            timer = timer_read();
            
            // Increment frame
            current_frame = (current_frame + 1) % (sizeof(epd_bitmap_allArray) / sizeof(epd_bitmap_allArray[0]));

            // Draw frame to OLED
            oled_write_raw_P(epd_bitmap_allArray[current_frame], frame_sizes[current_frame]); 
        }
    return false;
}
    
    
bool oled_task_user(void) {
    if (!is_oled_on()) return false; // exit early if the OLED is off

    // run animation at startup
    animation_on();
    
    static bool caps_lock_was_on = false; // Keep track of the caps lock state
    bool caps_lock_is_on = host_keyboard_led_state().caps_lock;
    
    if (caps_lock_is_on) {
        if (!caps_lock_was_on) {
            // Caps Lock is on, show the padlock image
            caps_lock_was_on = true; // Update the flag
            animation_enabled=false;
            static const unsigned char PROGMEM caps_active[] = {
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x80, 0xC0,
                0xE0, 0xF0, 0x70, 0xB0, 0xB0, 0xB0,
                0xB0, 0xB0, 0xB0, 0x70, 0xF0, 0xE0,
                0xC0, 0x80, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0xFE, 0xFF,
                0xFF, 0xF7, 0xFF, 0x06, 0x03, 0x01,
                0x01, 0x01, 0x01, 0x01, 0x01, 0x03,
                0x06, 0xFF, 0xF7, 0xFF, 0xFF, 0xFE,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0xE0, 0x70,
                0xD9, 0xD9, 0xF9, 0xD9, 0xD9, 0xD8,
                0xD8, 0xD8, 0xD8, 0xD8, 0xD8, 0xD8,
                0xD8, 0xD8, 0xD8, 0xD9, 0xD9, 0xF9,
                0xD9, 0xD9, 0x70, 0xE0, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
                0xFF, 0x1F, 0x0F, 0x07, 0x03, 0x03,
                0x03, 0x03, 0x07, 0x0F, 0x1F, 0xFF,
                0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0xFF, 0xFF, 0xFF, 0xFF,
                0xFF, 0xFF, 0xFF, 0xFF, 0xFE, 0xFC,
                0xF8, 0x00, 0x00, 0xF8, 0xFC, 0xFE,
                0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF,
                0xFF, 0xFF, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x03, 0x07,
                0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F,
                0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F,
                0x0F, 0x0F, 0x0F, 0x0F, 0x0F, 0x0F,
                0x0F, 0x0F, 0x07, 0x03, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                0x00, 0x00, 0x00, 0x00,
            };
            oled_write_raw_P((const char *)caps_active, sizeof(caps_active));
            return true; // Indicate that the display content has changed
        }
    } else {
        if (caps_lock_was_on) {
            // Caps Lock was on but now is off, clear the OLED or resume animation
            caps_lock_was_on = false; // Update the flag
            animation_enabled=true;
            // Clearing the OLED here might not be necessary if your animation function already refreshes the entire display
            // oled_clear(); // Consider clearing if your animation doesn't cover the whole screen
            // Return true here if you clear the screen or need to immediately update the display
        }

    }
    return animation_on() || !caps_lock_is_on;
    return false;
}
#endif

void matrix_scan_user(void) {
    static uint8_t encoder_button_state = 0;
    if (readPin(KC_ENCODER_PUSH) == 0) {
        if (encoder_button_state == 0) {
            encoder_button_state = 1;
            tap_code(KC_MPLY); // temporary action for testing
            //uprintf("Encoder button pressed\n");
        }
    } else if (encoder_button_state == 1) {
        encoder_button_state = 0;
        //uprintf("Encoder button released\n");
    }
    
    //Turn RGB off when not in use
    if (timer_elapsed32(keyboard_idle_timer) > 300000) { // 5 minutes
        if (rgblight_is_enabled()) {
            rgblight_disable();
        }
    }
}


bool process_record_user(uint16_t keycode, keyrecord_t *record) {    
      // Prints matrix position and status key pressed when console is enabled
    #ifdef CONSOLE_ENABLE
        uprintf("KL: kc: 0x%04X, row: %2u, col: %2u, pressed: %u, time: %5u, int: %u, count: %u\n", keycode, record->event.key.row, record->event.key.col, record->event.pressed, record->event.time, record->tap.interrupted, record->tap.count);
    #endif
    
    // Turn RGB on when a key is pressed
    if (record->event.pressed) {
        keyboard_idle_timer = timer_read32();
        if (!rgblight_is_enabled()) {
            rgblight_enable();
        }
    }
    return true;

    return true;
}

void suspend_power_down_user(void) {
    // TODO when host computer is off
    oled_off();
    rgblight_disable();
}

void suspend_wakeup_init_user(void) {
    // TODO when host computer is back on
    oled_on();
    rgblight_enable();
}




void keyboard_post_init_user(void) {
    // Delay for OLED power stabilization (Otherwise OLED won't start on cold boot (when unplugged and plugged back in) and will only work after being flashed and after pc reboot)
    wait_ms(100);
    // Enable NKRO from boot
    keymap_config.nkro = 1;
    // RGB starting state:
    rgblight_enable();
    rgblight_mode(6); // Sets the mode to rainbow
    // rgblight_sethsv(HSV_WHITE); // Sets the color to static white; To replace later
    
    // Initialize OLED
    oled_init(OLED_ROTATION_0); // OLED_ROTATION_180 if flipping the display
    oled_on();
}
